{% extends 'layout.html' %}

{% block content %}
<h2>Mes √âquipes</h2>

<ul>
    {% for team in teams %}
        <li>
            <a href="{% url 'users:team_detail' team.id %}">
                <strong>{{ team.name }}</strong> 
            </a>
            
            (Chef : {{ team.leader.first_name|default:"Inconnu" }}) 
        </li>
    {% empty %}
        <li>Vous ne faites partie d'aucune √©quipe pour le moment.</li>
    {% endfor %}
</ul> <div class="actions">
    <a href="{% url 'users:create_team' %}" class="btn">
        ‚ûï Cr√©er une nouvelle √©quipe
    </a>
</div>

<hr>

<h2>Mes Collections de Plasmides</h2>

{% if plasmid_collections %}
    <div class="collections-section">
        <table>
            <thead>
                <tr>
                    <th>Nom de la collection</th>
                    <th>Description</th>
                    <th>Plasmides</th>
                    <th>Date de cr√©ation</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for collection in plasmid_collections %}
                <tr>
                    <td><strong>{{ collection.name }}</strong></td>
                    <td>{{ collection.description|truncatewords:10 }}</td>
                    <td>{{ collection.plasmides.count }}</td>
                    <td>{{ collection.created_at|date:"d/m/Y H:i" }}</td>
                    <td>
                        <a href="{{ collection.plasmid_archive.url }}" class="btn btn-sm btn-info" title="T√©l√©charger">üì•</a>
                        <a href="{% url 'users:delete_collection' collection.id %}" class="btn btn-sm btn-danger" title="Supprimer" onclick="return confirm('√ätes-vous s√ªr de vouloir supprimer cette collection ?');">üóëÔ∏è</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% else %}
    <p>Aucune collection de plasmides cr√©√©e pour le moment.</p>
{% endif %}

<hr>

<h2>Mes Fichiers de Correspondance</h2>

{% if mapping_templates %}
    <div class="mappings-section">
        <table>
            <thead>
                <tr>
                    <th>Nom du fichier</th>
                    <th>Description</th>
                    <th>Date de cr√©ation</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for mapping in mapping_templates %}
                <tr>
                    <td><strong>{{ mapping.name }}</strong></td>
                    <td>{{ mapping.description|truncatewords:10 }}</td>
                    <td>{{ mapping.created_at|date:"d/m/Y H:i" }}</td>
                    <td>
                        <a href="{{ mapping.mapping_file.url }}" class="btn btn-sm btn-info" title="T√©l√©charger">üì•</a>
                        <a href="{% url 'users:delete_mapping' mapping.id %}" class="btn btn-sm btn-danger" title="Supprimer" onclick="return confirm('√ätes-vous s√ªr de vouloir supprimer ce fichier ?');">üóëÔ∏è</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% else %}
    <p>Aucun fichier de correspondance cr√©√© pour le moment.</p>
{% endif %}

<hr>

<h2>Mes Templates Publi√©s</h2>

{% if published_templates %}
    <div class="published-templates">
        <table>
            <thead>
                <tr>
                    <th>Nom du Template</th>
                    <th>Description</th>
                    <th>Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for t in published_templates %}
                <tr>
                    <td><strong>{{ t.name }}</strong></td>
                    <td>{{ t.description|truncatewords:10 }}</td>
                    <td>{{ t.created_at|date:"d/m/Y H:i" }}</td>
                    <td>
                        <a href="{% url 'templates:download_template' t.id %}" class="btn btn-sm btn-info" title="T√©l√©charger">üì•</a>
                        <a href="{% url 'templates:dashboard' %}?highlight={{ t.id }}" class="btn btn-sm btn-secondary" title="Voir sur le dashboard">üîé</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% else %}
    <p>Aucun template publi√© pour le moment.</p>
{% endif %}

<form action="{% url 'users:delete_user' user.id %}" method="post" onsubmit="return confirm('Attention ! Cette action est irr√©versible.')">
            {% csrf_token %}
            <button type="submit" class="btn-outline-danger" style="padding: 5px 10px; font-size: 0.8rem; background-color: #8B0000; color: white; border: none; border-radius: 4px; cursor: pointer;">
                Supprimer l'utilisateur
            </button>
        </form>
{% endblock %}